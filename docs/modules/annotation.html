
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Annotation Module &#8212; flyqma v0.1 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bleedthrough Module" href="bleedthrough.html" />
    <link rel="prev" title="Selection Module" href="selection.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <a class="reference external image-reference" href="https://amaral.northwestern.edu/"><img alt="nulogo" class="align-right" src="../_images/Northwestern_purple_RGB1.png" style="width: 30%;" /></a>
<div class="section" id="annotation-module">
<h1>Annotation Module<a class="headerlink" href="#annotation-module" title="Permalink to this headline">¶</a></h1>
<p><code class="docutils literal notranslate"><span class="pre">flyqma.annotation</span></code> provides several tools for labeling distinct subpopulations of cells within an image. Subpopulations are identified on the basis of their clonal marker expression level using a novel unsupervised classification strategy. Please see the Fly-QMA manuscript for a detailed description of the annotation strategy and its various parameters.</p>
<span class="target" id="module-flyqma.annotation.labelers"></span><dl class="class">
<dt id="flyqma.annotation.labelers.AttributeLabeler">
<em class="property">class </em><code class="descclassname">flyqma.annotation.labelers.</code><code class="descname">AttributeLabeler</code><span class="sig-paren">(</span><em>label</em>, <em>attribute</em>, <em>labels</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/labelers.html#AttributeLabeler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.labelers.AttributeLabeler" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns label to cell measurement data based on an existing attribute.</p>
<p>Attributes:</p>
<blockquote>
<div><p>label (str) - name of label field to be added</p>
<p>attribute (str) - existing cell attribute used to determine labels</p>
<p>labeler (vectorized func) - callable that maps attribute values to labels</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.labelers.AttributeLabeler.assign_labels">
<code class="descname">assign_labels</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/labelers.html#AttributeLabeler.assign_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.labelers.AttributeLabeler.assign_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign labels by adding &lt;label&gt; field to cell measurement data.</p>
<p>Args:</p>
<blockquote>
<div>data (pd.DataFrame) - cells measurement data with &lt;attribute&gt; field</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.labelers.CelltypeLabeler">
<em class="property">class </em><code class="descclassname">flyqma.annotation.labelers.</code><code class="descname">CelltypeLabeler</code><span class="sig-paren">(</span><em>label='celltype'</em>, <em>attribute='genotype'</em>, <em>labels=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/labelers.html#CelltypeLabeler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.labelers.CelltypeLabeler" title="Permalink to this definition">¶</a></dt>
<dd><p>Assigns &lt;celltype&gt; to cell measurement data based on &lt;genotype&gt; attribute.</p>
<p>Attributes:</p>
<blockquote>
<div><p>label (str) - name of label field to be added</p>
<p>attribute (str) - existing cell attribute used to determine labels</p>
<p>labeler (vectorized func) - callable that maps attribute values to labels</p>
</div></blockquote>
</dd></dl>

<span class="target" id="module-flyqma.annotation.annotation"></span><dl class="class">
<dt id="flyqma.annotation.annotation.Annotation">
<em class="property">class </em><code class="descclassname">flyqma.annotation.annotation.</code><code class="descname">Annotation</code><span class="sig-paren">(</span><em>attribute</em>, <em>sampler_type='radial'</em>, <em>sampler_kwargs={}</em>, <em>min_num_components=3</em>, <em>max_num_components=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for assigning labels to measurements. Object is trained on one or more graphs by fitting a bivariate mixture model and using a model selection procedure to select an optimal number of components.</p>
<p>The trained model may then be used to label measurements in other graphs, either through direct prediction via the bivariate mixture model or through a hybrid prediction combining the bivariate mixture model with a marginal univariate model.</p>
<p>Attributes:</p>
<blockquote>
<div><p>classifier (Classifier derivative) - callable object</p>
<p>attribute (str) - attribute used to determine labels</p>
</div></blockquote>
<p>Parameters:</p>
<blockquote>
<div><p>sampler_type (str) - either ‘radial’, ‘neighbors’, ‘community’</p>
<p>sampler_kwargs (dict) - keyword arguments for sampler</p>
<p>min_num_components (int) - minimum number of mixture components</p>
<p>max_num_components (int) - maximum number of mixture components</p>
<p>kwargs: keyword arguments for Classifier</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.annotate">
<code class="descname">annotate</code><span class="sig-paren">(</span><em>graph</em>, <em>bivariate_only=False</em>, <em>threshold=0.8</em>, <em>alpha=0.9</em>, <em>sampler_type=None</em>, <em>sampler_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.annotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.annotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Annotate graph of measurements.</p>
<p>Args:</p>
<blockquote>
<div><p>graph (spatial.WeightedGraph)</p>
<p>bivariate_only (bool) - if True, only use posteriors evaluated using the bivariate mixture model. Otherwise, use the marginal univariate posterior by default, replacing uncertain values with their counterparts estimated by the bivariate model.</p>
<p>threshold (float) - minimum marginal posterior probability of a given label before spatial context is considered</p>
<p>alpha (float) - attenuation factor</p>
<p>sampler_type (str) - either ‘radial’, ‘neighbors’ or ‘community’</p>
<p>sampler_kwargs (dict) - keyword arguments for sampling</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>labels (np.ndarray[int]) - labels for each measurement in graph</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.combine_posteriors">
<code class="descname">combine_posteriors</code><span class="sig-paren">(</span><em>posterior</em>, <em>marginal_posterior</em>, <em>threshold=0.8</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.combine_posteriors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.combine_posteriors" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace uncertain posterior probablilities with their more certain marginal counterparts. If the maximum marginal posterior probability for a given sample does not meet the specified threshold while the maximum bivarite posterior probability does, the latter value is used. Otherwise, the marginal value is used.</p>
<p>Args:</p>
<blockquote>
<div><p>posterior (np.ndarray[float]) - posterior probabilities of each label</p>
<p>marginal_posterior (np.ndarray[float]) - marginal posterior probabilities of each label</p>
<p>threshold (float) - minimum marginal posterior probability of a given label before spatial context is considered</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>combined (np.ndarray[float])</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.annotation.Annotation.copy">
<em class="property">classmethod </em><code class="descname">copy</code><span class="sig-paren">(</span><em>src</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate from another &lt;source&gt; annotator instance.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.annotation.Annotation.diffuse_posteriors">
<em class="property">static </em><code class="descname">diffuse_posteriors</code><span class="sig-paren">(</span><em>graph</em>, <em>posterior</em>, <em>alpha=0.9</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.diffuse_posteriors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.diffuse_posteriors" title="Permalink to this definition">¶</a></dt>
<dd><p>Diffuse estimated posterior probabilities of each label along the weighted edges of the graph.</p>
<p>Args:</p>
<blockquote>
<div><p>graph (Graph) - graph connecting adjacent measurements</p>
<p>posterior (np.ndarray[float]) - posterior probabiltiy of each label</p>
<p>alpha (float) - attenuation factor</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>diffused_posteriors (np.ndarray[float])</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.evaluate_marginal_posterior">
<code class="descname">evaluate_marginal_posterior</code><span class="sig-paren">(</span><em>sample</em>, <em>margin</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.evaluate_marginal_posterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.evaluate_marginal_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates posterior probability of each label using only the specified marginal distribution.</p>
<p>Args:</p>
<blockquote>
<div><p>sample (np.ndarray[float]) - sample values</p>
<p>margin (int) - index of desired margin</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>marginal_posterior (np.ndarray[float])</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.annotation.Annotation.from_data">
<em class="property">classmethod </em><code class="descname">from_data</code><span class="sig-paren">(</span><em>data</em>, <em>attribute</em>, <em>xykey=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.from_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.from_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate annotation object from measurement data.</p>
<p>Args:</p>
<blockquote>
<div><p>data (pd.DataFrame) - measurement data containing &lt;attribute&gt;, as well as &lt;xykey&gt; fields</p>
<p>attribute (str) - name of attribute used to classify cells</p>
<p>xykey (list) - name of attributes defining measurement x/y position</p>
<p>kwargs: keyword arguments for Annotation</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>annotator (Annotation derivative)</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.annotation.Annotation.from_layer">
<em class="property">classmethod </em><code class="descname">from_layer</code><span class="sig-paren">(</span><em>layer</em>, <em>attribute</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.from_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.from_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate from layer.</p>
<p>Args:</p>
<blockquote>
<div><p>layer (data.Layer) - image layer instance</p>
<p>attribute (str) - name of attribute used to classify cells</p>
<p>kwargs: keyword arguments for Annotation</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>annotator (Annotation derivative)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.get_sample">
<code class="descname">get_sample</code><span class="sig-paren">(</span><em>graph</em>, <em>sampler_type</em>, <em>sampler_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.get_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.get_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Get sample to be annotated. A sample consists of a columns of measured levels adjoined to a column of levels averaged over the neighborhood of each measurement.</p>
<p>Args:</p>
<blockquote>
<div><p>graph (spatial.WeightedGraph)</p>
<p>sampler_type (str) - either ‘radial’, ‘neighbors’ or ‘community’</p>
<p>sampler_kwargs (dict) - keyword arguments for sampling</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>sample (np.ndarray[float]) - sampled levels</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.get_sampler">
<code class="descname">get_sampler</code><span class="sig-paren">(</span><em>graph</em>, <em>sampler_type=None</em>, <em>sampler_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.get_sampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.get_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate sampler.</p>
<p>Args:</p>
<blockquote>
<div><p>graph (spatial.WeightedGraph)</p>
<p>sampler_type (str) - either ‘radial’, ‘neighbors’ or ‘community’</p>
<p>sampler_kwargs (dict) - keyword arguments for sampling</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>sampler</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.Annotation.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>*graphs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#Annotation.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.Annotation.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train classifier on a series of graphs.</p>
<p>Args:</p>
<blockquote>
<div>graphs (Graph or WeightedGraph) - graphs of adjacent measurements</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.annotation.AnnotationIO">
<em class="property">class </em><code class="descclassname">flyqma.annotation.annotation.</code><code class="descname">AnnotationIO</code><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#AnnotationIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.AnnotationIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for saving and loading an Annotation instance.</p>
<dl class="classmethod">
<dt id="flyqma.annotation.annotation.AnnotationIO.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#AnnotationIO.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.AnnotationIO.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load annotator from file.</p>
<p>Args:</p>
<blockquote>
<div>path (str) - path to annotation directory</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>annotator (Annotation derivative)</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.annotation.AnnotationIO.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#flyqma.annotation.annotation.AnnotationIO.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of parameter values.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.annotation.AnnotationIO.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dirpath</em>, <em>data=False</em>, <em>image=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/annotation.html#AnnotationIO.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.annotation.AnnotationIO.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save annotator to specified path.</p>
<p>Args:</p>
<blockquote>
<div><p>dirpath (str) - directory in which annotator is to be saved</p>
<p>data (bool) - if True, save training data</p>
<p>image (bool) - if True, save classifier image</p>
<p>kwargs: keyword arguments for image rendering</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<div class="section" id="mixture-models">
<h2>Mixture Models<a class="headerlink" href="#mixture-models" title="Permalink to this headline">¶</a></h2>
<p>Tools for fitting univariate and bivariate gaussian mixture models.</p>
<span class="target" id="module-flyqma.annotation.mixtures.univariate"></span><dl class="class">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.univariate.</code><code class="descname">MixtureProperties</code><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#MixtureProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Properties for guassian mixture models.</p>
<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.AIC">
<code class="descname">AIC</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.AIC" title="Permalink to this definition">¶</a></dt>
<dd><p>AIC score.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.BIC">
<code class="descname">BIC</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.BIC" title="Permalink to this definition">¶</a></dt>
<dd><p>BIC score.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.bounds">
<code class="descname">bounds</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Low and upper bounds of support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.component_pdfs">
<code class="descname">component_pdfs</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.component_pdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns stacked array of component PDFs.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.components">
<code class="descname">components</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.components" title="Permalink to this definition">¶</a></dt>
<dd><p>Individual model components.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.lbound">
<code class="descname">lbound</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.lbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Lower bound of support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.log_likelihood">
<code class="descname">log_likelihood</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximized log likelihood.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.means">
<code class="descname">means</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.means" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean value of each component.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.num_components">
<code class="descname">num_components</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.num_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of model components.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.num_samples">
<code class="descname">num_samples</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.num_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.pdf">
<code class="descname">pdf</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Gaussian Mixture PDF.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.scale_factor">
<code class="descname">scale_factor</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.scale_factor" title="Permalink to this definition">¶</a></dt>
<dd><p>Scaling factor for log-transformed support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.stds">
<code class="descname">stds</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.stds" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard deviation of each component.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.support">
<code class="descname">support</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.support" title="Permalink to this definition">¶</a></dt>
<dd><p>Distribution support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.support_size">
<code class="descname">support_size</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.support_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Size of support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.univariate.MixtureProperties.ubound">
<code class="descname">ubound</code><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.MixtureProperties.ubound" title="Permalink to this definition">¶</a></dt>
<dd><p>Upper bound of support.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.univariate.</code><code class="descname">UnivariateMixture</code><span class="sig-paren">(</span><em>*args</em>, <em>values=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Univariate Gaussian mixture model.</p>
<p>Attributes:</p>
<blockquote>
<div>values (array like) - values to which model was fit</div></blockquote>
<p>Inherited attributes:</p>
<blockquote>
<div>See sklearn.mixture.GaussianMixture</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.estimate_required_samples">
<code class="descname">estimate_required_samples</code><span class="sig-paren">(</span><em>SNR=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.estimate_required_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.estimate_required_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns minimum number of averaged samples required to achieve the specified signal to noise (SNR) ratio.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.from_logsample">
<em class="property">classmethod </em><code class="descname">from_logsample</code><span class="sig-paren">(</span><em>sample</em>, <em>n=3</em>, <em>max_iter=10000</em>, <em>tol=1e-08</em>, <em>covariance_type='diag'</em>, <em>n_init=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.from_logsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.from_logsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate from log-transformed sample.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.from_parameters">
<em class="property">classmethod </em><code class="descname">from_parameters</code><span class="sig-paren">(</span><em>mu</em>, <em>sigma</em>, <em>weights=None</em>, <em>values=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.from_parameters"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.from_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate model from parameter vectors.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.from_sample">
<em class="property">classmethod </em><code class="descname">from_sample</code><span class="sig-paren">(</span><em>sample</em>, <em>n</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.from_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.from_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate from log-normally distributed sample.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.get_component_pdf">
<code class="descname">get_component_pdf</code><span class="sig-paren">(</span><em>idx</em>, <em>weighted=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.get_component_pdf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.get_component_pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns PDF for indexed component.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.logsample">
<code class="descname">logsample</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.logsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.logsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &lt;N&gt; samples of log-transformed variable.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.multi_logsample">
<code class="descname">multi_logsample</code><span class="sig-paren">(</span><em>N</em>, <em>m=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.multi_logsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.multi_logsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &lt;N&gt; log-transformed samples as well as &lt;N&gt; log-transformed samples averaged over &lt;m&gt; other samples from the same component.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.multi_sample">
<code class="descname">multi_sample</code><span class="sig-paren">(</span><em>N</em>, <em>m=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.multi_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.multi_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &lt;N&gt; samples as well as &lt;N&gt; samples averaged over &lt;m&gt; other samples from the same component.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.sample">
<code class="descname">sample</code><span class="sig-paren">(</span><em>N</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &lt;N&gt; samples of variable.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.univariate.UnivariateMixture.sample_component">
<code class="descname">sample_component</code><span class="sig-paren">(</span><em>component_idx</em>, <em>N</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/univariate.html#UnivariateMixture.sample_component"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.univariate.UnivariateMixture.sample_component" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns &lt;N&gt; log-transformed samples from indexed component.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.mixtures.bivariate"></span><dl class="class">
<dt id="flyqma.annotation.mixtures.bivariate.BivariateMixture">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.bivariate.</code><code class="descname">BivariateMixture</code><span class="sig-paren">(</span><em>*args</em>, <em>values=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/bivariate.html#BivariateMixture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.bivariate.BivariateMixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Bivariate Gaussian mixture model.</p>
<p>Inherited attributes:</p>
<blockquote>
<div><p>values (array like) - values to which model was fit</p>
<p>See sklearn.mixture.GaussianMixture</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.mixtures.bivariate.BivariateMixture.get_marginal_mixture">
<code class="descname">get_marginal_mixture</code><span class="sig-paren">(</span><em>margin</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/bivariate.html#BivariateMixture.get_marginal_mixture"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.bivariate.BivariateMixture.get_marginal_mixture" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns univariate mixture model for specified &lt;margin&gt;.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.bivariate.</code><code class="descname">BivariateMixtureProperties</code><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/bivariate.html#BivariateMixtureProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Extension properties for bivariate mixtures.</p>
<dl class="attribute">
<dt id="flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties.extent">
<code class="descname">extent</code><a class="headerlink" href="#flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties.extent" title="Permalink to this definition">¶</a></dt>
<dd><p>Extent for x and y axes.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties.supportx">
<code class="descname">supportx</code><a class="headerlink" href="#flyqma.annotation.mixtures.bivariate.BivariateMixtureProperties.supportx" title="Permalink to this definition">¶</a></dt>
<dd><p>Support for first dimension.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.mixtures.visualization"></span><dl class="class">
<dt id="flyqma.annotation.mixtures.visualization.BivariateVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.visualization.</code><code class="descname">BivariateVisualization</code><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/visualization.html#BivariateVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.BivariateVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualization methods for bivariate mixture models.</p>
<dl class="attribute">
<dt id="flyqma.annotation.mixtures.visualization.BivariateVisualization.tick_positions">
<code class="descname">tick_positions</code><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.BivariateVisualization.tick_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Tick positions.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.mixtures.visualization.BivariateVisualization.visualize">
<code class="descname">visualize</code><span class="sig-paren">(</span><em>size_ratio=4</em>, <em>figsize=(2</em>, <em>2)</em>, <em>contours=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/visualization.html#BivariateVisualization.visualize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.BivariateVisualization.visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize joint and marginal distributions.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.mixtures.visualization.MixtureVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.mixtures.visualization.</code><code class="descname">MixtureVisualization</code><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/visualization.html#MixtureVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.MixtureVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualization methods for mixture models.</p>
<dl class="attribute">
<dt id="flyqma.annotation.mixtures.visualization.MixtureVisualization.summary">
<code class="descname">summary</code><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.MixtureVisualization.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns text-based summary of mixture model.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.mixtures.visualization.figure">
<code class="descclassname">flyqma.annotation.mixtures.visualization.</code><code class="descname">figure</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/visualization.html#figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.figure" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for creating axis.</p>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.mixtures.visualization.surface_figure">
<code class="descclassname">flyqma.annotation.mixtures.visualization.</code><code class="descname">surface_figure</code><span class="sig-paren">(</span><em>func</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/mixtures/visualization.html#surface_figure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.mixtures.visualization.surface_figure" title="Permalink to this definition">¶</a></dt>
<dd><p>Decorator for creating joint axis.</p>
</dd></dl>

</div>
<div class="section" id="model-selection">
<h2>Model Selection<a class="headerlink" href="#model-selection" title="Permalink to this headline">¶</a></h2>
<p>Tools for statistical model selection.</p>
<span class="target" id="module-flyqma.annotation.model_selection.univariate"></span><dl class="class">
<dt id="flyqma.annotation.model_selection.univariate.SelectionIO">
<em class="property">class </em><code class="descclassname">flyqma.annotation.model_selection.univariate.</code><code class="descname">SelectionIO</code><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#SelectionIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.SelectionIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for saving and loading a model selection instance.</p>
<dl class="classmethod">
<dt id="flyqma.annotation.model_selection.univariate.SelectionIO.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#SelectionIO.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.SelectionIO.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model selection instance from file.</p>
<p>Args:</p>
<blockquote>
<div>path (str) - model selection directory</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>selector (UnivariateModelSelection derivative)</div></blockquote>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.model_selection.univariate.SelectionIO.load_model">
<em class="property">static </em><code class="descname">load_model</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#SelectionIO.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.SelectionIO.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model from &lt;path&gt; directory.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.model_selection.univariate.SelectionIO.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dirpath</em>, <em>image=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#SelectionIO.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.SelectionIO.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save classifier to specified path.</p>
<p>Args:</p>
<blockquote>
<div><p>dirpath (str) - directory in which classifier is to be saved</p>
<p>image (bool) - if True, save model image</p>
<p>kwargs: keyword arguments for image rendering</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>path (str) - model selection directory</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection">
<em class="property">class </em><code class="descclassname">flyqma.annotation.model_selection.univariate.</code><code class="descname">UnivariateModelSelection</code><span class="sig-paren">(</span><em>values</em>, <em>attribute</em>, <em>min_num_components=3</em>, <em>max_num_components=8</em>, <em>models=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#UnivariateModelSelection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for performing univariate mixture model selection. The optimal model is chosen based on BIC score.</p>
<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.AIC">
<code class="descname">AIC</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.AIC" title="Permalink to this definition">¶</a></dt>
<dd><p>AIC scores for each model.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.AIC_optimal">
<code class="descname">AIC_optimal</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.AIC_optimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Model with AIC optimal number of components.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.BIC">
<code class="descname">BIC</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.BIC" title="Permalink to this definition">¶</a></dt>
<dd><p>BIC scores for each model.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.BIC_optimal">
<code class="descname">BIC_optimal</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.BIC_optimal" title="Permalink to this definition">¶</a></dt>
<dd><p>Model with BIC optimal number of components.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.fit_model">
<em class="property">static </em><code class="descname">fit_model</code><span class="sig-paren">(</span><em>values</em>, <em>num_components</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#UnivariateModelSelection.fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified number of components.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.fit_models">
<code class="descname">fit_models</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/univariate.html#UnivariateModelSelection.fit_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.fit_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with each number of components.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.models">
<code class="descname">models</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.models" title="Permalink to this definition">¶</a></dt>
<dd><p>List of models ordered by number of components.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.model_selection.univariate.UnivariateModelSelection.parameters">
<code class="descname">parameters</code><a class="headerlink" href="#flyqma.annotation.model_selection.univariate.UnivariateModelSelection.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of instance parameters.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.model_selection.bivariate"></span><dl class="class">
<dt id="flyqma.annotation.model_selection.bivariate.BivariateModelSelection">
<em class="property">class </em><code class="descclassname">flyqma.annotation.model_selection.bivariate.</code><code class="descname">BivariateModelSelection</code><span class="sig-paren">(</span><em>values</em>, <em>attribute</em>, <em>min_num_components=3</em>, <em>max_num_components=8</em>, <em>models=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/bivariate.html#BivariateModelSelection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.bivariate.BivariateModelSelection" title="Permalink to this definition">¶</a></dt>
<dd><p>Bivariate extension for model selection.</p>
<dl class="staticmethod">
<dt id="flyqma.annotation.model_selection.bivariate.BivariateModelSelection.fit_model">
<em class="property">static </em><code class="descname">fit_model</code><span class="sig-paren">(</span><em>values</em>, <em>num_components</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/bivariate.html#BivariateModelSelection.fit_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.bivariate.BivariateModelSelection.fit_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit model with specified number of components.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.model_selection.bivariate.BivariateModelSelection.load_model">
<em class="property">static </em><code class="descname">load_model</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/bivariate.html#BivariateModelSelection.load_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.bivariate.BivariateModelSelection.load_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Load model from &lt;path&gt; directory.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.model_selection.visualization"></span><dl class="class">
<dt id="flyqma.annotation.model_selection.visualization.ModelSelectionVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.model_selection.visualization.</code><code class="descname">ModelSelectionVisualization</code><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/visualization.html#ModelSelectionVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.visualization.ModelSelectionVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for visualizing model selection procedure.</p>
<dl class="method">
<dt id="flyqma.annotation.model_selection.visualization.ModelSelectionVisualization.plot_models">
<code class="descname">plot_models</code><span class="sig-paren">(</span><em>panelsize=(3</em>, <em>2)</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/model_selection/visualization.html#ModelSelectionVisualization.plot_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.model_selection.visualization.ModelSelectionVisualization.plot_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot model for each number of components.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="label-assignment">
<h2>Label Assignment<a class="headerlink" href="#label-assignment" title="Permalink to this headline">¶</a></h2>
<p>Tools for unsupervised classification of cell measurements.</p>
<span class="target" id="module-flyqma.annotation.classification.classifiers"></span><dl class="class">
<dt id="flyqma.annotation.classification.classifiers.Classifier">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.classifiers.</code><code class="descname">Classifier</code><span class="sig-paren">(</span><em>values</em>, <em>attribute=None</em>, <em>num_labels=3</em>, <em>log=True</em>, <em>cmap=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifier base class. Children of this class must possess a means attribute, as well as a predict method.</p>
<p>Attributes:</p>
<blockquote>
<div><p>values (array like) - basis for clustering</p>
<p>attribute (str or list) - attribute(s) used to determine labels</p>
<p>log (bool) - indicates whether clustering performed on log values</p>
<p>num_labels (int) - number of output labels</p>
<p>classifier (vectorized func) - maps value to label_id</p>
<p>labels (np.ndarray[int]) - predicted labels</p>
<p>cmap (matplotlib.colors.ColorMap) - colormap for label_id</p>
<p>parameters (dict) - {param name: param value} pairs</p>
<p>fig (matplotlib.figures.Figure) - histogram figure</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.Classifier.build_classifier">
<code class="descname">build_classifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.build_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.build_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Build function that returns the most probable label for each of a series of values.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.Classifier.build_colormap">
<code class="descname">build_colormap</code><span class="sig-paren">(</span><em>cmap</em>, <em>vmin=-1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.build_colormap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.build_colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Build normalized colormap for class labels.</p>
<p>Args:</p>
<blockquote>
<div><p>cmap (matplotlib.colormap)</p>
<p>vmin (float) - lower bound for colorscale</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>colormap (func) - function mapping class labels to colors</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.Classifier.evaluate_classifier">
<code class="descname">evaluate_classifier</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.evaluate_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.evaluate_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign class labels to &lt;data&gt;.</p>
<p>Args:</p>
<blockquote>
<div>data (pd.DataFrame) - must contain necessary attributes</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>labels (np.ndarray[int])</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.classification.classifiers.Classifier.from_grouped_measurements">
<em class="property">classmethod </em><code class="descname">from_grouped_measurements</code><span class="sig-paren">(</span><em>data</em>, <em>attribute</em>, <em>groupby=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.from_grouped_measurements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.from_grouped_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to data grouped by a specified feature.</p>
<p>Args:</p>
<blockquote>
<div><p>data (pd.DataFrame) - measurement data</p>
<p>groupby (str) - attribute used to group measurement data</p>
<p>attribute (str or list) - attribute(s) on which to cluster</p>
<p>kwargs: keyword arguments for classifier</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>classifier (Classifier derivative)</div></blockquote>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.classification.classifiers.Classifier.from_measurements">
<em class="property">classmethod </em><code class="descname">from_measurements</code><span class="sig-paren">(</span><em>data</em>, <em>attribute</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.from_measurements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.from_measurements" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit classifier to data.</p>
<p>Args:</p>
<blockquote>
<div><p>data (pd.DataFrame) - measurement data</p>
<p>attribute (str or list) - attribute(s) on which to cluster</p>
<p>kwargs: keyword arguments for classifier</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>classifier (Classifier derivative)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.Classifier.set_cmap">
<code class="descname">set_cmap</code><span class="sig-paren">(</span><em>cmap=None</em>, <em>vmin=0</em>, <em>vmax=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.set_cmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.set_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Set colormap for class labels.</p>
<p>Args:</p>
<blockquote>
<div><p>cmap (matplotlib.colormap)</p>
<p>vmin (int) - lower bound for color scale</p>
<p>vmax (int) - upper bound for color scale</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.Classifier.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#Classifier.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.Classifier.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize classification.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.classification.classifiers.ClassifierIO">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.classifiers.</code><code class="descname">ClassifierIO</code><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#ClassifierIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for saving and loading classifier objects.</p>
<dl class="classmethod">
<dt id="flyqma.annotation.classification.classifiers.ClassifierIO.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#ClassifierIO.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierIO.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load classifier from file.</p>
<p>Args:</p>
<blockquote>
<div>path (str) - path to classifier directory</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>classifier (Classifier derivative)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.classifiers.ClassifierIO.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dirpath</em>, <em>data=False</em>, <em>image=True</em>, <em>extension=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#ClassifierIO.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierIO.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save classifier to specified path.</p>
<p>Args:</p>
<blockquote>
<div><p>dirpath (str) - directory in which classifier is to be saved</p>
<p>data (bool) - if True, save training data</p>
<p>image (bool) - if True, save labeled histogram image</p>
<p>extension (str) - directory name extension</p>
<p>kwargs: keyword arguments for image rendering</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.classifiers.</code><code class="descname">ClassifierProperties</code><a class="reference internal" href="../_modules/flyqma/annotation/classification/classifiers.html#ClassifierProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Properties for classifier objects.</p>
<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.centroids">
<code class="descname">centroids</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.centroids" title="Permalink to this definition">¶</a></dt>
<dd><p>Means of each component (not log transformed).</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.component_groups">
<code class="descname">component_groups</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.component_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>List of lists of components for each label.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.component_to_label">
<code class="descname">component_to_label</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.component_to_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns dictionary mapping components to labels.  Mapping is achieved by k-means clustering the model centroids (linear scale).</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.num_samples">
<code class="descname">num_samples</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.num_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of samples.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.order">
<code class="descname">order</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Ordered component indices (low to high).</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.classifiers.ClassifierProperties.values">
<code class="descname">values</code><a class="headerlink" href="#flyqma.annotation.classification.classifiers.ClassifierProperties.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Values for classifier.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.classification.kmeans"></span><dl class="class">
<dt id="flyqma.annotation.classification.kmeans.KMeansClassifier">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.kmeans.</code><code class="descname">KMeansClassifier</code><span class="sig-paren">(</span><em>values</em>, <em>num_components=3</em>, <em>groups=None</em>, <em>log=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/kmeans.html#KMeansClassifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.kmeans.KMeansClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>K-means classifier.</p>
<p>Attributes:</p>
<blockquote>
<div><p>groups (dict) - {cluster_id: label_id} pairs for merging clusters</p>
<p>component_to_label (vectorized func) - maps cluster_id to label_id</p>
<p>km (sklearn.cluster.KMeans) - kmeans object</p>
<p>classifier (vectorized func) - maps value to label_id</p>
<p>labels (np.ndarray[int]) - predicted labels</p>
</div></blockquote>
<p>Inherited attributes:</p>
<blockquote>
<div><p>values (array like) - basis for clustering</p>
<p>attribute (str or list) - attribute(s) on which to cluster</p>
<p>log (bool) - indicates whether clustering performed on log values</p>
<p>cmap (matplotlib.colors.ColorMap) - colormap for label_id</p>
<p>parameters (dict) - {param name: param value} pairs</p>
<p>fig (matplotlib.figures.Figure) - histogram figure</p>
</div></blockquote>
<dl class="staticmethod">
<dt id="flyqma.annotation.classification.kmeans.KMeansClassifier.fit">
<em class="property">static </em><code class="descname">fit</code><span class="sig-paren">(</span><em>values</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/kmeans.html#KMeansClassifier.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.kmeans.KMeansClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit n clusters to x</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.kmeans.KMeansClassifier.means">
<code class="descname">means</code><a class="headerlink" href="#flyqma.annotation.classification.kmeans.KMeansClassifier.means" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of each cluster.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.kmeans.KMeansClassifier.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/kmeans.html#KMeansClassifier.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.kmeans.KMeansClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict which component each of &lt;values&gt; belongs to.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.classification.mixtures"></span><dl class="class">
<dt id="flyqma.annotation.classification.mixtures.BivariateMixtureClassifier">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.mixtures.</code><code class="descname">BivariateMixtureClassifier</code><span class="sig-paren">(</span><em>values</em>, <em>num_components=3</em>, <em>num_labels=3</em>, <em>fit_kw={}</em>, <em>model=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#BivariateMixtureClassifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.BivariateMixtureClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Bivariate mixed log-normal model classifier.</p>
<p>Attributes:</p>
<blockquote>
<div>model (mixtures.BivariateMixture) - frozen bivariate mixture model</div></blockquote>
<p>Inherited attributes:</p>
<blockquote>
<div><p>values (np.ndarray[float]) - basis for clustering</p>
<p>attribute (list) - attributes on which to cluster</p>
<p>num_labels (int) - number of labels</p>
<p>num_components (int) - number of mixture components</p>
<p>classifier (vectorized func) - maps values to labels</p>
<p>labels (np.ndarray[int]) - predicted labels</p>
<p>log (bool) - indicates whether clustering performed on log values</p>
<p>cmap (matplotlib.colors.ColorMap) - colormap for labels</p>
<p>parameters (dict) - {param name: param value} pairs</p>
</div></blockquote>
<dl class="staticmethod">
<dt id="flyqma.annotation.classification.mixtures.BivariateMixtureClassifier.fit">
<em class="property">static </em><code class="descname">fit</code><span class="sig-paren">(</span><em>values</em>, <em>num_components=3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#BivariateMixtureClassifier.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.BivariateMixtureClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit univariate gaussian mixture model.</p>
<p>Args:</p>
<blockquote>
<div><p>values (np.ndarray[float]) - 1D array of log-transformed values</p>
<p>num_components (int) - number of model components</p>
<p>kwargs: keyword arguments for fitting</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>model (mixtures.BivariateMixture)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.BivariateMixtureClassifier.marginalize">
<code class="descname">marginalize</code><span class="sig-paren">(</span><em>margin</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#BivariateMixtureClassifier.marginalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.BivariateMixtureClassifier.marginalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns UnivariateMixtureClassifier for specified margin.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.classification.mixtures.MixtureModelIO">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.mixtures.</code><code class="descname">MixtureModelIO</code><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#MixtureModelIO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.MixtureModelIO" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for saving and loading classifier objects.</p>
<dl class="classmethod">
<dt id="flyqma.annotation.classification.mixtures.MixtureModelIO.load">
<em class="property">classmethod </em><code class="descname">load</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#MixtureModelIO.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.MixtureModelIO.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load classifier from file.</p>
<p>Args:</p>
<blockquote>
<div>path (str) - path to classifier directory</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>classifier (Classifier derivative)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.MixtureModelIO.save">
<code class="descname">save</code><span class="sig-paren">(</span><em>dirpath</em>, <em>data=False</em>, <em>image=True</em>, <em>extension=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#MixtureModelIO.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.MixtureModelIO.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save classifier to specified path.</p>
<p>Args:</p>
<blockquote>
<div><p>dirpath (str) - directory in which classifier is to be saved</p>
<p>data (bool) - if True, save training data</p>
<p>image (bool) - if True, save labeled histogram image</p>
<p>extension (str) - directory name extension</p>
<p>kwargs: keyword arguments for image rendering</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.mixtures.</code><code class="descname">UnivariateMixtureClassifier</code><span class="sig-paren">(</span><em>values</em>, <em>num_components=3</em>, <em>num_labels=3</em>, <em>fit_kw={}</em>, <em>model=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Univariate mixed log-normal model classifier.</p>
<p>Attributes:</p>
<blockquote>
<div><p>model (mixtures.UnivariateMixture) - frozen univariate mixture model</p>
<p>num_components (int) - number of mixture components</p>
<p>classifier (vectorized func) - maps values to labels</p>
<p>labels (np.ndarray[int]) - predicted labels</p>
</div></blockquote>
<p>Inherited attributes:</p>
<blockquote>
<div><p>values (np.ndarray[float]) - basis for clustering</p>
<p>num_labels (int) - number of output labels</p>
<p>log (bool) - indicates whether clustering performed on log values</p>
<p>cmap (matplotlib.colors.ColorMap) - colormap for labels</p>
<p>parameters (dict) - {param name: param value} pairs</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.build_classifier">
<code class="descname">build_classifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.build_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.build_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Build function that returns the most probable label for each of a series of values.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.build_posterior">
<code class="descname">build_posterior</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.build_posterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.build_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Build function that returns the posterior probability of each label given a series of values.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.evaluate_posterior">
<code class="descname">evaluate_posterior</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.evaluate_posterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.evaluate_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns posterior across components for &lt;data&gt;.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.fit">
<em class="property">static </em><code class="descname">fit</code><span class="sig-paren">(</span><em>values</em>, <em>num_components=3</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit univariate gaussian mixture model.</p>
<p>Args:</p>
<blockquote>
<div><p>values (np.ndarray[float]) - 1D array of log-transformed values</p>
<p>num_components (int) - number of model components</p>
<p>kwargs: keyword arguments for fitting</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>model (mixtures.UnivariateMixture)</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.means">
<code class="descname">means</code><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.means" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean of each component.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.num_components">
<code class="descname">num_components</code><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.num_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of model components.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict which component each of &lt;values&gt; belongs to.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.predict_proba">
<code class="descname">predict_proba</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/classification/mixtures.html#UnivariateMixtureClassifier.predict_proba"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.mixtures.UnivariateMixtureClassifier.predict_proba" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the posterior probability with which each of &lt;values&gt; belongs to each component.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.classification.visualization"></span><dl class="class">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.classification.visualization.</code><code class="descname">MixtureVisualization</code><a class="reference internal" href="../_modules/flyqma/annotation/classification/visualization.html#MixtureVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for visualizing a mixture-model based classifier.</p>
<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.component_cdfs">
<code class="descname">component_cdfs</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.component_cdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns weighted CDF of each component over support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.component_pdfs">
<code class="descname">component_pdfs</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.component_pdfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted component PDFs over support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.ecdf">
<code class="descname">ecdf</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.ecdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Empirical CDF over support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.epdf">
<code class="descname">epdf</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.epdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Empirical PDF over support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.esupport">
<code class="descname">esupport</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.esupport" title="Permalink to this definition">¶</a></dt>
<dd><p>Empirical support vector (sorted values).</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.label_colors">
<code class="descname">label_colors</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.label_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>RGB color for each class label.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.pdf">
<code class="descname">pdf</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.pdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Model PDF over support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.support">
<code class="descname">support</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.support" title="Permalink to this definition">¶</a></dt>
<dd><p>Model support.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.classification.visualization.MixtureVisualization.support_labels">
<code class="descname">support_labels</code><a class="headerlink" href="#flyqma.annotation.classification.visualization.MixtureVisualization.support_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Labels for support vector.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="spatial-analysis">
<h2>Spatial Analysis<a class="headerlink" href="#spatial-analysis" title="Permalink to this headline">¶</a></h2>
<p>Tools for analyzing the 2D spatial arrangement of cells.</p>
<span class="target" id="module-flyqma.annotation.spatial.triangulation"></span><dl class="class">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.triangulation.</code><code class="descname">LocalTriangulation</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation" title="Permalink to this definition">¶</a></dt>
<dd><p>Triangulation with edge distance filter.</p>
<p>Attributes:</p>
<blockquote>
<div><p>edge_list (np.ndarray[int]) - (from, to) node pairs</p>
<p>edge_lengths (np.ndarray[float]) - euclidean length of each edge</p>
</div></blockquote>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.angle_threshold">
<code class="descname">angle_threshold</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.angle_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicted upper bound on edge angles.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.angles">
<code class="descname">angles</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Angle on [0, 2p] interval.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.compile_edge_list">
<code class="descname">compile_edge_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.compile_edge_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.compile_edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of (node_from, node_to) tuples.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.edge_angles">
<code class="descname">edge_angles</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.edge_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Angular distance of each edge about origin.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.edge_radii">
<code class="descname">edge_radii</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.edge_radii" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimum node radius in each edge.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.edges">
<code class="descname">edges</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Filtered edges.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.evaluate_edge_lengths">
<em class="property">static </em><code class="descname">evaluate_edge_lengths</code><span class="sig-paren">(</span><em>edge_list</em>, <em>x</em>, <em>y</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.evaluate_edge_lengths"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.evaluate_edge_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns 1D array of edge lengths.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_edges">
<em class="property">classmethod </em><code class="descname">filter_edges</code><span class="sig-paren">(</span><em>nodes</em>, <em>edges</em>, <em>lengths</em>, <em>max_length=0.1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.filter_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all edges less than &lt;max_length&gt;, with at least one edge containing each node.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_hull">
<code class="descname">filter_hull</code><span class="sig-paren">(</span><em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.filter_hull"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_hull" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all edges not on the convex hull.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_longest_edge">
<code class="descname">filter_longest_edge</code><span class="sig-paren">(</span><em>edges</em>, <em>edge_lengths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.filter_longest_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_longest_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all edges except the longest edge in each triangle.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_outliers">
<em class="property">classmethod </em><code class="descname">filter_outliers</code><span class="sig-paren">(</span><em>nodes</em>, <em>edges</em>, <em>lengths</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.filter_outliers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.filter_outliers" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all edges whose lengths are not outliers, with at least one edge containing each node.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.find_disconnected_nodes">
<em class="property">static </em><code class="descname">find_disconnected_nodes</code><span class="sig-paren">(</span><em>nodes</em>, <em>edges</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.find_disconnected_nodes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.find_disconnected_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns boolean array of nodes not included in edges.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.find_first_edge">
<em class="property">static </em><code class="descname">find_first_edge</code><span class="sig-paren">(</span><em>edges</em>, <em>node</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.find_first_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.find_first_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns index of first edge containing &lt;node&gt;.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.hull">
<code class="descname">hull</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.hull" title="Permalink to this definition">¶</a></dt>
<dd><p>Convex hull.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.is_outlier">
<em class="property">static </em><code class="descname">is_outlier</code><span class="sig-paren">(</span><em>points</em>, <em>threshold=3.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/triangulation.html#LocalTriangulation.is_outlier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.is_outlier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a boolean array with True if points are outliers and False
otherwise.</p>
<p>Args:</p>
<blockquote>
<div><p>points (np.ndarray[float]) - 1-D array of observations</p>
<p>threshold (float) - Maximum modified z-score. Observations with a modified z-score (based on the median absolute deviation) greater are classified as outliers.</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>mask (np.ndarray[bool])</div></blockquote>
<p>References:</p>
<blockquote>
<div>Boris Iglewicz and David Hoaglin (1993), “Volume 16: How to Detect and Handle Outliers”, The ASQC Basic References in Quality Control:
Statistical Techniques, Edward F. Mykytka, Ph.D., Editor.</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>All nodes.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.num_triangles">
<code class="descname">num_triangles</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.num_triangles" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of triangles.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.radii">
<code class="descname">radii</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.radii" title="Permalink to this definition">¶</a></dt>
<dd><p>Radius.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.triangulation.LocalTriangulation.size">
<code class="descname">size</code><a class="headerlink" href="#flyqma.annotation.spatial.triangulation.LocalTriangulation.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of points.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.spatial.graphs"></span><dl class="class">
<dt id="flyqma.annotation.spatial.graphs.CommunityDetection">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">CommunityDetection</code><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#CommunityDetection"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.CommunityDetection" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for detecting communities in a Graph.</p>
<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.CommunityDetection.assign_community">
<code class="descname">assign_community</code><span class="sig-paren">(</span><em>level=None</em>, <em>key='community'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#CommunityDetection.assign_community"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.CommunityDetection.assign_community" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign communities using InfoMap clustering.</p>
<p>Args:</p>
<blockquote>
<div><p>level (int) - module level at which aggregation occurs, starting from the finest resolution</p>
<p>key (str) - name of community attribute</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.CommunityDetection.detect_communities">
<code class="descname">detect_communities</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#CommunityDetection.detect_communities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.CommunityDetection.detect_communities" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect communities using InfoMap clustering.</p>
<p>Accepts keyword arguments for InfoMap, including:</p>
<blockquote>
<div><p>twolevel (bool) - if True, perform two-level clustering, otherwise defaults to multi-level clustering</p>
<p>N (int) - number of trials</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.Graph">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">Graph</code><span class="sig-paren">(</span><em>data</em>, <em>xykey=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#Graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.Graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Object provides an undirected unweighted graph connecting adjacent cells.</p>
<p>Attributes:</p>
<blockquote>
<div><p>data (pd.DataFrame) - cell measurement data (nodes)</p>
<p>xykey (list) - attribute keys for node x/y positions</p>
<p>G (nx.Graph) - undirected graph instance</p>
<p>nodes (np.ndarray[int]) - node indices</p>
<p>edges (np.ndarray[int]) - pairs of connected node indices</p>
<p>node_map (vectorized func) - maps positional index to node index</p>
<p>position_map (vectorized func) - maps node index to positional index</p>
<p>tri (matplotlib.tri.Triangulation) - triangulation of node positions</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.Graph.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#Graph.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.Graph.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns deep copy of graph instance.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.Graph.get_correlations">
<code class="descname">get_correlations</code><span class="sig-paren">(</span><em>attribute</em>, <em>log=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#Graph.get_correlations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.Graph.get_correlations" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns SpatialCorrelation object for &lt;attribute&gt;.</p>
<p>Args:</p>
<blockquote>
<div><p>attribute (str) - name of attribute</p>
<p>log (bool) - if True, log-transform attribute values</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>correlations (SpatialCorrelation)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.Graph.get_networkx">
<code class="descname">get_networkx</code><span class="sig-paren">(</span><em>*node_attributes</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#Graph.get_networkx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.Graph.get_networkx" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns networkx instance of graph.</p>
<p>Args:</p>
<blockquote>
<div>node_attributes (str) - attributes to be added for each node</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.Graph.get_subgraph">
<code class="descname">get_subgraph</code><span class="sig-paren">(</span><em>ind</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#Graph.get_subgraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.Graph.get_subgraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate subgraph from DataFrame indices.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.GraphVisualizationMethods">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">GraphVisualizationMethods</code><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#GraphVisualizationMethods"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.GraphVisualizationMethods" title="Permalink to this definition">¶</a></dt>
<dd><p>Methods for visualizing a Graph instance.</p>
<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.GraphVisualizationMethods.label_triangles">
<code class="descname">label_triangles</code><span class="sig-paren">(</span><em>label_by='genotype'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#GraphVisualizationMethods.label_triangles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.GraphVisualizationMethods.label_triangles" title="Permalink to this definition">¶</a></dt>
<dd><p>Label each triangle with most common node attribute value.</p>
<p>Args:</p>
<blockquote>
<div>label_by (str) - node attribute used to label each triangle</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>labels (np.ndarray[int]) - labels for each triangle</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.GraphVisualizationMethods.plot_edges">
<code class="descname">plot_edges</code><span class="sig-paren">(</span><em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#GraphVisualizationMethods.plot_edges"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.GraphVisualizationMethods.plot_edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot triangulation edges.</p>
<p>Args:</p>
<blockquote>
<div><p>ax (matplotlib.axes.AxesSubplot)</p>
<p>kwargs: keyword arguments for matplotlib.pyplot.triplot</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.GraphVisualizationMethods.plot_triangles">
<code class="descname">plot_triangles</code><span class="sig-paren">(</span><em>label_by='genotype'</em>, <em>cmap=None</em>, <em>ax=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#GraphVisualizationMethods.plot_triangles"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.GraphVisualizationMethods.plot_triangles" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot triangle faces using tripcolor.</p>
<p>Args:</p>
<blockquote>
<div><p>label_by (str) - data attribute used to color each triangle</p>
<p>cmap (matplotlib.colors.ColorMap) - colormap for attribute values</p>
<p>ax (matplotlib.axes.AxesSubplot)</p>
<p>kwargs: keyword arguments for plt.tripcolor</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.GraphVisualizationMethods.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>ax=None</em>, <em>colorby=None</em>, <em>disconnect=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#GraphVisualizationMethods.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.GraphVisualizationMethods.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize graph.</p>
<p>Args:</p>
<blockquote>
<div><p>ax (matplotlib.axes.AxesSubplot) - if None, create figure</p>
<p>colorby (str) - node attribute used to assign node/edge colors</p>
<p>disconnect (bool) - if True, remove edges between nodes whose colorby values differ</p>
<p>kwargs: keyword arguments for NetworkxGraphVisualization.draw</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.NetworkxGraphVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">NetworkxGraphVisualization</code><span class="sig-paren">(</span><em>G</em>, <em>pos</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#NetworkxGraphVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.NetworkxGraphVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for visualizing a NetworkX Graph object.</p>
<p>Attributes:</p>
<blockquote>
<div><p>G (nx.Graph) - networkx graph object</p>
<p>pos (np.ndarray[float]) - 2D node positions</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.NetworkxGraphVisualization.build_cmap">
<code class="descname">build_cmap</code><span class="sig-paren">(</span><em>colorby</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#NetworkxGraphVisualization.build_cmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.NetworkxGraphVisualization.build_cmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Build colormap.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.NetworkxGraphVisualization.draw">
<code class="descname">draw</code><span class="sig-paren">(</span><em>ax=None</em>, <em>colorby=None</em>, <em>edge_color='k'</em>, <em>node_color='k'</em>, <em>cmap=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#NetworkxGraphVisualization.draw"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.NetworkxGraphVisualization.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw graph.</p>
<p>Args:</p>
<blockquote>
<div><p>ax (matplotlib.axes.AxesSubplot) - axis on which to draw graph</p>
<p>colorby (str) - node attribute on which nodes/edges are colored</p>
<p>edge_color, node_color (str) - edge/node colors, overrides colorby</p>
<p>node_cmap (matplotlib.colors.ColorMap) - node colormap</p>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">SpatialProperties</code><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#SpatialProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Spatial properties for Graph objects.</p>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.distance_matrix">
<code class="descname">distance_matrix</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Euclidean distance matrix between all nodes.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.edge_lengths">
<code class="descname">edge_lengths</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.edge_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique edge lengths.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.evaluate_fluctuations">
<em class="property">static </em><code class="descname">evaluate_fluctuations</code><span class="sig-paren">(</span><em>values</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#SpatialProperties.evaluate_fluctuations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.evaluate_fluctuations" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct pairwise fluctuation matrix for &lt;values&gt;.</p>
<p>Args:</p>
<blockquote>
<div>values (1D np.ndarray[float]) - attribute values</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>fluctuations (2D np.ndarray[float]) - pairwise fluctuations</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.get_fluctuations_matrix">
<code class="descname">get_fluctuations_matrix</code><span class="sig-paren">(</span><em>attribute</em>, <em>log=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#SpatialProperties.get_fluctuations_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.get_fluctuations_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns normalized pairwise fluctuations of &lt;attribute&gt; value for each node in the graph.</p>
<p>Args:</p>
<blockquote>
<div><p>attribute (str) - name of attribute</p>
<p>log (bool) - if True, log-transform attribute values</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>fluctuations (2D np.ndarray[float]) - pairwise fluctuations</div></blockquote>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.get_matrix_upper">
<em class="property">static </em><code class="descname">get_matrix_upper</code><span class="sig-paren">(</span><em>matrix</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#SpatialProperties.get_matrix_upper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.get_matrix_upper" title="Permalink to this definition">¶</a></dt>
<dd><p>Return upper triangular portion of a 2-D matrix.</p>
<p>Parameters:</p>
<blockquote>
<div>matrix (2D np.ndarray)</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>upper (1D np.ndarray) - upper triangle, ordered row then column</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.median_edge_length">
<code class="descname">median_edge_length</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.median_edge_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Median edge length.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.node_positions">
<code class="descname">node_positions</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.node_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign 2D coordinate positions to nodes.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.node_positions_arr">
<code class="descname">node_positions_arr</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.node_positions_arr" title="Permalink to this definition">¶</a></dt>
<dd><p>N x 2 array of node coordinates, ordered by positional index.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.SpatialProperties.unique_distances">
<code class="descname">unique_distances</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.SpatialProperties.unique_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Upper triangular portion of euclidean distance matrix.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">TopologicalProperties</code><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#TopologicalProperties"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties" title="Permalink to this definition">¶</a></dt>
<dd><p>Topological properties for Graph objects.</p>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.adjacency">
<code class="descname">adjacency</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.adjacency" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjacency matrix ordered by &lt;self.nodes&gt;.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.adjacency_positional">
<code class="descname">adjacency_positional</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.adjacency_positional" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjacency matrix ordered by positional index in &lt;self.data&gt;.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.edge_list">
<code class="descname">edge_list</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance-filtered edges as (from, to) tuples.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.edges">
<code class="descname">edges</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.edges" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance-filtered edges.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.nodes">
<code class="descname">nodes</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Unique nodes in graph.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.nodes_order">
<code class="descname">nodes_order</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.nodes_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Indices that sort nodes by positional index in &lt;self.data&gt;.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.TopologicalProperties.num_nodes">
<code class="descname">num_nodes</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.TopologicalProperties.num_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.WeightFunction">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">WeightFunction</code><span class="sig-paren">(</span><em>data</em>, <em>weighted_by='r'</em>, <em>distance=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for weighting graph edges by similarity.</p>
<p>Attributes:</p>
<blockquote>
<div><p>data (pd.DataFrame) - nodes data</p>
<p>weighted_by (str) - node attribute used to assess similarity</p>
<p>values (pd.Series) - node attribute values</p>
<p>distance (bool) - if True, weights edges by distance</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.WeightFunction.assess_weights">
<code class="descname">assess_weights</code><span class="sig-paren">(</span><em>edges</em>, <em>logratio=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightFunction.assess_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightFunction.assess_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate edge weights normalized by mean difference in node values.</p>
<p>Args:</p>
<blockquote>
<div><p>edges (list of (i, j) tuples) - edges between nodes i and j</p>
<p>logratio (bool) - if True, weight edges by logratio</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>weights (np.ndarray[float]) - edge weights</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.WeightFunction.difference">
<code class="descname">difference</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightFunction.difference"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightFunction.difference" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate difference in values between nodes i and j.</p>
<p>Args:</p>
<blockquote>
<div>i, j (ind) - node indices</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>difference (float)</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.WeightFunction.logratio">
<code class="descname">logratio</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightFunction.logratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightFunction.logratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate log ratio between nodes i and j.</p>
<p>Args:</p>
<blockquote>
<div>i, j (ind) - node indices</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>logratio (float)</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.graphs.WeightedGraph">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.graphs.</code><code class="descname">WeightedGraph</code><span class="sig-paren">(</span><em>data</em>, <em>weighted_by</em>, <em>xykey=None</em>, <em>logratio=True</em>, <em>distance=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightedGraph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightedGraph" title="Permalink to this definition">¶</a></dt>
<dd><p>Object provides an undirected weighted graph connecting adjacent cells. Edge weights are evaluated based on the similarity of expression between pairs of connected nodes. Node similariy is based on the cell measurement data attribute specified by the ‘weighted_by’ parameter.</p>
<p>Attributes:</p>
<blockquote>
<div><p>weighted_by (str) - data attribute used to weight edges</p>
<p>imap (spatial.InfoMap) - community detection</p>
<p>community_labels (np.ndarray[int]) - community label for each node</p>
<p>logratio (bool) - if True, weight edges by log ratio</p>
<p>distance (bool) - if True, weights edges by distance rather than similarity</p>
</div></blockquote>
<p>Inherited attributes:</p>
<blockquote>
<div><p>data (pd.DataFrame) - cell measurement data (nodes)</p>
<p>xykey (list) - attribute keys for node x/y positions</p>
<p>nodes (np.ndarray[int]) - node indices</p>
<p>edges (np.ndarray[int]) - pairs of connected node indices</p>
<p>node_map (vectorized func) - maps positional index to node index</p>
<p>position_map (vectorized func) - maps node index to positional index</p>
<p>tri (matplotlib.tri.Triangulation) - triangulation of node positions</p>
</div></blockquote>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.graphs.WeightedGraph.edge_list">
<code class="descname">edge_list</code><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightedGraph.edge_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance-filtered edges as (from, to, weight) tuples.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.graphs.WeightedGraph.evaluate_edge_weights">
<code class="descname">evaluate_edge_weights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/graphs.html#WeightedGraph.evaluate_edge_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.graphs.WeightedGraph.evaluate_edge_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate edge weights.</p>
<p>Returns:</p>
<blockquote>
<div>weights (np.ndarray[float]) - edge weights</div></blockquote>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.spatial.correlation"></span><dl class="class">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.correlation.</code><code class="descname">CharacteristicLength</code><span class="sig-paren">(</span><em>correlation</em>, <em>fraction_of_max=0.01</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for determining the characteristic length over which correlations decay.</p>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.characteristic_length">
<code class="descname">characteristic_length</code><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.characteristic_length" title="Permalink to this definition">¶</a></dt>
<dd><p>Characteristic decay length.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.extract_decay">
<em class="property">static </em><code class="descname">extract_decay</code><span class="sig-paren">(</span><em>correlation</em>, <em>fraction_of_max</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength.extract_decay"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.extract_decay" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract decay.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.fit">
<em class="property">static </em><code class="descname">fit</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>model</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength.fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit exponential decay model to decay vectors.</p>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.model">
<em class="property">static </em><code class="descname">model</code><span class="sig-paren">(</span><em>x</em>, <em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength.model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.model" title="Permalink to this definition">¶</a></dt>
<dd><p>Exponential decay model.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.plot_fit">
<code class="descname">plot_fit</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength.plot_fit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.plot_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot model fit.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.plot_measured">
<code class="descname">plot_measured</code><span class="sig-paren">(</span><em>ax</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CharacteristicLength.plot_measured"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.plot_measured" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot measured correlation decay.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.x_normed">
<code class="descname">x_normed</code><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.x_normed" title="Permalink to this definition">¶</a></dt>
<dd><p>Distance vector normalized by maximum value.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.correlation.CharacteristicLength.yp">
<code class="descname">yp</code><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CharacteristicLength.yp" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicted correlation values.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.correlation.CorrelationVisualization">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.correlation.</code><code class="descname">CorrelationVisualization</code><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#CorrelationVisualization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.CorrelationVisualization" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualization methods for SpatialCorrelation.</p>
</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.correlation.SpatialCorrelation">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.correlation.</code><code class="descname">SpatialCorrelation</code><span class="sig-paren">(</span><em>d_ij=None</em>, <em>C_ij=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/correlation.html#SpatialCorrelation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.correlation.SpatialCorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for correlations between 1-D timeseries.</p>
<p>Attributes:</p>
<blockquote>
<div><p>d_ij (np array) - pairwise separation distances between measurements</p>
<p>C_ij (np array) - normalized pairwise fluctuations between measurements</p>
</div></blockquote>
</dd></dl>

<span class="target" id="module-flyqma.annotation.spatial.infomap"></span><dl class="class">
<dt id="flyqma.annotation.spatial.infomap.CommunityAggregator">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.infomap.</code><code class="descname">CommunityAggregator</code><span class="sig-paren">(</span><em>infomap</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/infomap.html#CommunityAggregator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.infomap.CommunityAggregator" title="Permalink to this definition">¶</a></dt>
<dd><p>Tool for hierarchical aggregation of communities.</p>
</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.infomap.InfoMap">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.infomap.</code><code class="descname">InfoMap</code><span class="sig-paren">(</span><em>edges</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/infomap.html#InfoMap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.infomap.InfoMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Object for performing infomap flow-based community detection.</p>
<p>Attributes:</p>
<blockquote>
<div><p>infomap (infomap.Infomap) - infomap object</p>
<p>node_to_module (dict) - {node: module} pairs</p>
<p>classifier (vectorized func) - maps nodes to modules</p>
<p>aggregator (CommunityAggregator)</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.infomap.InfoMap.build_classifier">
<code class="descname">build_classifier</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/infomap.html#InfoMap.build_classifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.infomap.InfoMap.build_classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct node to module classifier.</p>
<p>Returns:</p>
<blockquote>
<div><p>node_to_module (dict) - {node: module} pairs</p>
<p>classifier (vectorized func) - maps nodes to modules</p>
</div></blockquote>
</dd></dl>

<dl class="staticmethod">
<dt id="flyqma.annotation.spatial.infomap.InfoMap.build_network">
<em class="property">static </em><code class="descname">build_network</code><span class="sig-paren">(</span><em>edges</em>, <em>twolevel=False</em>, <em>N=25</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/infomap.html#InfoMap.build_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.infomap.InfoMap.build_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Compile InfoMap object from graph edges.</p>
<p>Args:</p>
<blockquote>
<div><p>twolevel (bool) - if True, perform two-level clustering</p>
<p>N (int) - number of trials</p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.infomap.InfoMap.max_depth">
<code class="descname">max_depth</code><a class="headerlink" href="#flyqma.annotation.spatial.infomap.InfoMap.max_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum tree depth.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.infomap.InfoMap.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>report=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/infomap.html#InfoMap.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.infomap.InfoMap.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Run infomap community detection.</p>
<p>Args:</p>
<blockquote>
<div>report (bool) - if True, print number of modules found</div></blockquote>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.spatial.sampling"></span><dl class="class">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.sampling.</code><code class="descname">CommunitySampler</code><span class="sig-paren">(</span><em>graph</em>, <em>attr</em>, <em>depth=1.0</em>, <em>log=True</em>, <em>twolevel=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#CommunitySampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for sampling node attributes averaged over local community.</p>
<p>Attributes:</p>
<blockquote>
<div><p>graph (spatial.Graph) - graph instance</p>
<p>G (nx.Graph) - graph with node attribute</p>
<p>attr (str) - attribute to be averaged over neighbors</p>
<p>depth (int) - mean correlation lifetime</p>
<p>level (int) - hierarchical level at which clusters are merged</p>
<p>log (bool) - if True, log-transform values before averaging</p>
<p>twolevel (bool) - if True, use two-level community clustering</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.autocorrelate">
<code class="descname">autocorrelate</code><span class="sig-paren">(</span><em>include_distances=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#CommunitySampler.autocorrelate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.autocorrelate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns autocorrelation versus community depth.</p>
<p>Args:</p>
<blockquote>
<div>include_distances (bool) - return mean separate distances</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>levels (list) - clustering depths, starting from finest resolution</p>
<p>correlations (list) - mean correlation within communities</p>
<p>&lt;optional&gt; distances (list) - mean pairwise separation distance</p>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.average_over_neighbors">
<code class="descname">average_over_neighbors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#CommunitySampler.average_over_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.average_over_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Average attribute value over all members of the community encompassing each node.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.averaged_attr">
<code class="descname">averaged_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.averaged_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of averaged attribute.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.clustering_level">
<code class="descname">clustering_level</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.clustering_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Highest clustering level at which the mean correlation remains above &lt;self.depth&gt; multiples of the decay constant.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.neighbors">
<code class="descname">neighbors</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of neighbor indices keyed by node indices.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.size_attr">
<code class="descname">size_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.size_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighborhood size attribute name.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.CommunitySampler.z_attr">
<code class="descname">z_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.CommunitySampler.z_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of z-scored attribute.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.sampling.</code><code class="descname">NeighborSampler</code><span class="sig-paren">(</span><em>graph</em>, <em>attr</em>, <em>depth=1</em>, <em>log=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#NeighborSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for sampling node attributes averaged over neighbors.</p>
<p>Attributes:</p>
<blockquote>
<div><p>graph (spatial.Graph) - graph instance</p>
<p>G (nx.Graph) - graph with node attribute</p>
<p>attr (str) - attribute to be averaged over neighbors</p>
<p>depth (int) - maximum number of edges connecting neighbors</p>
<p>log (bool) - if True, log-transform values before averaging</p>
</div></blockquote>
<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.G">
<code class="descname">G</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.G" title="Permalink to this definition">¶</a></dt>
<dd><p>NetworkX graph instance.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.add_attribute_to_graph">
<code class="descname">add_attribute_to_graph</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#NeighborSampler.add_attribute_to_graph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.add_attribute_to_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Add attribute to networkx graph object.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.attr_used">
<code class="descname">attr_used</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.attr_used" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of attribute used to access graph data.</p>
</dd></dl>

<dl class="method">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.average_over_neighbors">
<code class="descname">average_over_neighbors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#NeighborSampler.average_over_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.average_over_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Average attribute value over all neighbors adjacent to each node.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.averaged_attr">
<code class="descname">averaged_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.averaged_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of averaged attribute.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.data">
<code class="descname">data</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.data" title="Permalink to this definition">¶</a></dt>
<dd><p>Graph data.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.keys">
<code class="descname">keys</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.keys" title="Permalink to this definition">¶</a></dt>
<dd><p>List of attribute names.</p>
</dd></dl>

<dl class="classmethod">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.multisample">
<em class="property">classmethod </em><code class="descname">multisample</code><span class="sig-paren">(</span><em>attr</em>, <em>*graphs</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#NeighborSampler.multisample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.multisample" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate composite sample from one or more &lt;graphs&gt;.</p>
<p>Args:</p>
<blockquote>
<div><p>attr (str) - attribute to be averaged over neighbors</p>
<p>graphs (spatial.Graph) - one or more graph instances</p>
<p>kwargs: keyword arguments for sampler</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>sample (np.ndarray[float]) - 2D array of sampled values, first column contains cell measurements while the second column contains measurements averaged over the neighbors of each cell</p>
<p>keys (list of str) - attribute keys for sampled data</p>
</div></blockquote>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.neighbors">
<code class="descname">neighbors</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of neighbor indices keyed by node indices.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.node_values">
<code class="descname">node_values</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.node_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector of attribute values for each node.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.node_values_dict">
<code class="descname">node_values_dict</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.node_values_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of attribute values, keyed by node index.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.num_nodes">
<code class="descname">num_nodes</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.num_nodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of nodes.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.sample">
<code class="descname">sample</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns bivariate sample combining each node’s attribute value with the average attribute value in its neighborhood.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.NeighborSampler.size_attr">
<code class="descname">size_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.NeighborSampler.size_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighborhood size attribute name.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler">
<em class="property">class </em><code class="descclassname">flyqma.annotation.spatial.sampling.</code><code class="descname">RadialSampler</code><span class="sig-paren">(</span><em>graph</em>, <em>attr</em>, <em>depth=1.0</em>, <em>log=True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#RadialSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for sampling node attributes averaged within a predetermined radius of each node.</p>
<p>Attributes:</p>
<blockquote>
<div><p>graph (spatial.Graph) - graph instance</p>
<p>G (nx.Graph) - graph with node attribute</p>
<p>attr (str) - attribute to be averaged over neighbors</p>
<p>depth (int) - hierarchical level to which communities are merged</p>
<p>log (bool) - if True, log-transform values before averaging</p>
<p>length_scale (float) - characteristic length scale of the graph</p>
<p>radius (float) - radius of sampling region surrounding each measurement</p>
</div></blockquote>
<dl class="method">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler.average_over_neighbors">
<code class="descname">average_over_neighbors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/sampling.html#RadialSampler.average_over_neighbors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler.average_over_neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Average attribute value over all nodes within the specified radius of each node.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler.averaged_attr">
<code class="descname">averaged_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler.averaged_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of averaged attribute.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler.distance_matrix">
<code class="descname">distance_matrix</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler.distance_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Euclidean distance matrix between nodes (ordered by position in &lt;self.data&gt;).</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler.neighbors">
<code class="descname">neighbors</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler.neighbors" title="Permalink to this definition">¶</a></dt>
<dd><p>Dictionary of neighbor positional indices keyed by node indices.</p>
</dd></dl>

<dl class="attribute">
<dt id="flyqma.annotation.spatial.sampling.RadialSampler.size_attr">
<code class="descname">size_attr</code><a class="headerlink" href="#flyqma.annotation.spatial.sampling.RadialSampler.size_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Neighborhood size attribute name.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-flyqma.annotation.spatial.timeseries"></span><dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.apply_custom_roller">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">apply_custom_roller</code><span class="sig-paren">(</span><em>func</em>, <em>x</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#apply_custom_roller"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.apply_custom_roller" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply function to rolling window.</p>
<p>Args:</p>
<blockquote>
<div><p>func (function) - function applied to each window, returns 1 x N_out</p>
<p>x (np.ndarray) - ordered samples, length N</p>
<p>kwargs: keyword arguments for window specification</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>fx (np.ndarray) - function output for each window, N/resolution x N_out</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.bootstrap">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">bootstrap</code><span class="sig-paren">(</span><em>x</em>, <em>func=&lt;function mean&gt;</em>, <em>confidence=95</em>, <em>N=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#bootstrap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.bootstrap" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns point estimate obtained by parametric bootstrap.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>func (function) - function applied to each bootstrap sample</p>
<p>confidence (float) - confidence interval, between 0 and 100</p>
<p>N (int) - number of bootstrap samples</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>interval (np.ndarray) - confidence interval bounds</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.detrend_signal">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">detrend_signal</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=99</em>, <em>order=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#detrend_signal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.detrend_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>Detrend and scale fluctuations using first-order univariate spline.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np array) -ordered samples</p>
<p>window_size (int) - size of interpolation window for lowpass filter</p>
<p>order (int) - spline order</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div><p>residuals (np array) - detrended residuals</p>
<p>trend (np array) - spline fit to signal</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_binned_mean">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_binned_mean</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_binned_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_binned_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns mean values within non-overlapping sequential windows.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>window_size (int) - size of window, W</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>means (np.ndarray) - bin means, N/W x 1</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_rolling_gaussian">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_rolling_gaussian</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em>, <em>resolution=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_rolling_gaussian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_rolling_gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns gaussian fit within sliding window.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples</p>
<p>window_size (int) - size of window</p>
<p>resolution (int) - sampling interval</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>model (scipy.stats.norm)</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_rolling_mean">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_rolling_mean</code><span class="sig-paren">(</span><em>x</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_rolling_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_rolling_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute rolling mean. This implementation permits flexible sampling intervals and multi-dimensional time series, but is slower than get_running_mean for 1D time series.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>kw: arguments for window specification</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>means (np.ndarray) - moving average of x, N/resolution x 1</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_rolling_mean_interval">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_rolling_mean_interval</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em>, <em>resolution=1</em>, <em>confidence=95</em>, <em>nbootstraps=1000</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_rolling_mean_interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_rolling_mean_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate confidence interval for moving average of ordered values.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>window_size (int) - size of window, W</p>
<p>resolution (int) - sampling interval</p>
<p>confidence (float) - confidence interval, between 0 and 100</p>
<p>nbootstraps (int) - number of bootstrap samples</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>interval (np.ndarray) - confidence interval bounds, N/resolution x 2</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_rolling_window">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_rolling_window</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em>, <em>resolution=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_rolling_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_rolling_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Return array slices within a rolling window.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>window_size (int) - size of window, W</p>
<p>resolution (int) - sampling interval</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>windows (np.ndarray) - sampled values, N/resolution x W</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.get_running_mean">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">get_running_mean</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#get_running_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.get_running_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns running mean for a 1D vector. This is the fastest implementation, but is limited to one-dimensional arrays and doesn’t permit interval specification.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>window_size (int) - size of window, W</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>means (np.ndarray) - moving average of x</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.plot_mean">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">plot_mean</code><span class="sig-paren">(</span><em>ax</em>, <em>x</em>, <em>y</em>, <em>label=None</em>, <em>ma_type='sliding'</em>, <em>window_size=100</em>, <em>resolution=1</em>, <em>line_color='k'</em>, <em>line_width=1</em>, <em>line_alpha=1</em>, <em>linestyle=None</em>, <em>markersize=2</em>, <em>smooth=False</em>, <em>**kw</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#plot_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.plot_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot moving average.</p>
<p>Args:</p>
<blockquote>
<div><p>x, y (array like) - timeseries data</p>
<p>ax (matplotlib.axes.AxesSubplot) - axis which to which line is added</p>
<p>label (str) - data label</p>
<p>ma_type (str) - type of average used, either sliding, binned, or savgol</p>
<p>window_size (int) - size of window</p>
<p>resolution (int) - sampling interval</p>
<p>line_color, line_width, line_alpha, linestyle - formatting parameters</p>
<p>smooth (bool) - if True, apply secondary savgol filter</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>line (matplotlib.lines.Line2D)</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.plot_mean_interval">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">plot_mean_interval</code><span class="sig-paren">(</span><em>ax</em>, <em>x</em>, <em>y</em>, <em>ma_type='sliding'</em>, <em>window_size=100</em>, <em>resolution=10</em>, <em>nbootstraps=1000</em>, <em>confidence=95</em>, <em>color='grey'</em>, <em>alpha=0.25</em>, <em>error_bars=False</em>, <em>lw=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#plot_mean_interval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.plot_mean_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds confidence interval for line average (sliding window or binned) to existing axes.</p>
<p>Args:</p>
<blockquote>
<div><p>x, y (array like) - data</p>
<p>ax (axes) - axis which to which line is added</p>
<p>ma_type (str) - type of average used, either ‘sliding’ or ‘binned’</p>
<p>window_size (int) - size of sliding window or bin (num of cells)</p>
<p>interval_resolution (int) - sampling resolution for confidence interval</p>
<p>nbootstraps (int) - number of bootstraps</p>
<p>confidence (float) - confidence interval, between 0 and 100</p>
<p>color, alpha - formatting parameters</p>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.savgol">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">savgol</code><span class="sig-paren">(</span><em>x</em>, <em>window_size=100</em>, <em>polyorder=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#savgol"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.savgol" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Savitzky-Golay filtration of 1-D array.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples</p>
<p>window_size (int) - filter size</p>
<p>polyorder (int) - polynomial order</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>trend (np.ndarray) - smoothed values</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.smooth">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">smooth</code><span class="sig-paren">(</span><em>x</em>, <em>window</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#smooth"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.smooth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns smoothed moving average of &lt;x&gt; within &lt;window&gt;.</p>
</dd></dl>

<dl class="function">
<dt id="flyqma.annotation.spatial.timeseries.subsample">
<code class="descclassname">flyqma.annotation.spatial.timeseries.</code><code class="descname">subsample</code><span class="sig-paren">(</span><em>x</em>, <em>frac=1</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/flyqma/annotation/spatial/timeseries.html#subsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#flyqma.annotation.spatial.timeseries.subsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Subsample array with replacement.</p>
<p>Args:</p>
<blockquote>
<div><p>x (np.ndarray) - ordered samples, length N</p>
<p>frac (float) - sample size (fraction of array)</p>
</div></blockquote>
<p>Returns:</p>
<blockquote>
<div>sample (np.ndarray) - subsampled values</div></blockquote>
</dd></dl>

</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/graphics/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">INSTALLATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start.html">GETTING STARTED</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">EXAMPLE USAGE</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../documentation.html">DOCUMENTATION</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="data.html">Data Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="measurement.html">Measurement Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="selection.html">Selection Module</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Annotation Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="bleedthrough.html">Bleedthrough Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contact.html">CONTACT</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../documentation.html">Documentation</a><ul>
      <li>Previous: <a href="selection.html" title="previous chapter">Selection Module</a></li>
      <li>Next: <a href="bleedthrough.html" title="next chapter">Bleedthrough Module</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Amaral Lab.
      
      |
      <a href="../_sources/modules/annotation.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>